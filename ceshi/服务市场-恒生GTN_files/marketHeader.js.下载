require(["domReady!","avalon","jquery","common/common","jquery.cookie","jquery.actual","apiMenu"],function(A,B,F,C){var D=B.define({$id:"marketHeader",isCompany:true,username:"",deal_status:"",left:"",search_doc:"",service_content:"",login:false,tologin:function(){F.cookie("_u_",window.location,{path:"/",expires:10});var G=window.location.href;C.ajax({url:"user/setUserBehavior.json",type:"get",data:{userBehavior:G},callback:function(H){window.location.href="/login/login.html"}})},regist:function(){var G=window.location.href;C.ajax({url:"user/setUserBehavior.json",type:"get",data:{userBehavior:G},callback:function(H){window.location.href="/registration/regist.html"}})},logout:function(){C.ajax({url:"user/loginExit.json",type:"get",data:"",callback:function(G){D.toggleLogin(false);F.cookie("_t_","",{path:"/",expires:-1});F.cookie("_n_","",{path:"/",expires:-1});F.cookie("_u_",window.location,{path:"/",expires:10});window.location.href="/login/login.html"}})},queryByServerName:function(){C.ajax({url:"/queryMarketDetailList.json",dataType:"json",type:"post",data:{service_content:vm.service_content},async:false,callback:function(G){console.log(G)},failure:function(G){C.alertNodePop(G.error_info)}})},isHaveService:function(){C.ajax({url:"api/queryServiceInfo.json",dataType:"json",type:"post",data:{pageSize:10,currentPage:1,category:0},async:false,callback:function(G){if(G!=null){if(G.pageBean.totalItem==0){window.location.href="/manage/usingService"}else{window.location.href="/manage/serviceManage"}}},failure:function(G){if(G.error_code=="404291"){F.cookie("_u_",window.location,{path:"/",expires:10});window.location.href="/login/login.html"}else{C.alertNodePop(G.error_info)}}})},toggleLogin:function(G){if(!G){F("#unlogin").show();F("#login").hide();D.login=false}else{F("#login").show();F("#unlogin").hide();D.login=true}},});F(function(){});function E(){var G=C.isLogin();if(G!=""){D.toggleLogin(true);D.username=G;C.ajax({url:"user/islogin.json",dataType:"json",type:"post",callback:function(H){if(H.userType==2){D.isCompany=true}else{D.isCompany=false}F("#cas_logout_url").attr("href",H.cas_logout_url)},failure:function(H){if(H.error_code=="291"){F.cookie("_u_",window.location,{path:"/",expires:10});window.location.href="/login/login.html"}else{C.alertNodePop(H.error_info)}}})}else{D.toggleLogin(false)}}F(function(){E()});B.scan()});