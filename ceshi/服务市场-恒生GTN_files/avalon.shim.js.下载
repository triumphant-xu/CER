/*!2018-08-02 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Avalon requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(){a.console&&avalon.config.debug&&Function.apply.call(console.log,console,arguments)}function d(){}function e(a,b){"string"==typeof a&&(a=a.match(Ca)||[]);for(var c={},d=void 0!==b?b:1,e=0,f=a.length;e<f;e++)c[a[e]]=d;return c}function f(a){function b(d,e){return c.push(d)>a&&delete b[c.shift()],b[d]=e}var c=[];return b}function g(){if(a.VBArray){var b=document.documentMode;return b?b:a.XMLHttpRequest?7:6}return 0}function h(a){return Fa.test(Ia.call(a))}function i(a,b){return a=Math.floor(a)||0,a<0?Math.max(b+a,0):Math.min(a,b)}function j(a){if(!a)return!1;var b=a.length;if(b===b>>>0){var c=Ia.call(a).slice(8,-1);if(/(?:regexp|string|function|window|global)$/i.test(c))return!1;if("Array"===c)return!0;try{return{}.propertyIsEnumerable.call(a,"length")!==!1||/^\s?function/.test(a.item||a.callee)}catch(b){return!a.window}}return!1}function k(a,b,c){var d="for(var "+a+"i=0,n = this.length; i < n; i++){"+b.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+c;return Function("fn,scope",d)}function l(a,b){try{for(;b=b.parentNode;)if(b===a)return!0;return!1}catch(a){return!1}}function m(){return(new XMLSerializer).serializeToString(this)}function o(a,b){if(a&&a.childNodes)for(var c,d=a.childNodes,e=0;c=d[e++];)if(c.tagName){var f=ua.createElementNS(bb,c.tagName.toLowerCase());Ja.forEach.call(c.attributes,function(a){f.setAttribute(a.name,a.value)}),o(c,f),b.appendChild(f)}}function p(a){var b={};for(var c in a)b[c]=a[c];var d=b.target=a.srcElement;if(0===a.type.indexOf("key"))b.which=null!=a.charCode?a.charCode:a.keyCode;else if(db.test(a.type)){var e=d.ownerDocument||ua,f="BackCompat"===e.compatMode?e.body:e.documentElement;b.pageX=a.clientX+(f.scrollLeft>>0)-(f.clientLeft>>0),b.pageY=a.clientY+(f.scrollTop>>0)-(f.clientTop>>0),b.wheelDeltaY=b.wheelDelta,b.wheelDeltaX=0}return b.timeStamp=new Date-0,b.originalEvent=a,b.preventDefault=function(){a.returnValue=!1},b.stopPropagation=function(){a.cancelBubble=!0},b}function q(a){for(var b in a)if(Ha.call(a,b)){var c=a[b];"function"==typeof q.plugins[b]?q.plugins[b](c):"object"==typeof q[b]?avalon.mix(q[b],c):q[b]=c}return this}function r(a){return(a+"").replace(mb,"\\$&")}function s(a,b,c){if(Ta(b)||b&&b.nodeType)return!1;if(c.indexOf(a)!==-1)return!1;if(tb.indexOf(a)!==-1)return!1;var d=c.$special;return!(a&&"$"===a.charAt(0)&&!d[a])}function t(a,b,c,d){switch(a.type){case 0:var e=a.get,f=a.set;if(Ta(f)){var g=d.$events,h=g[b];g[b]=[],f.call(d,c),g[b]=h}return e.call(d);case 1:return c;case 2:if(c!==d.$model[b]){var i=a.svmodel=w(d,b,c,a.valueType);c=i.$model;var j=ub[i.$id];j&&j()}return c}}function u(a,b,c){if(Array.isArray(a)){var e=a.concat();a.length=0;var f=y(a);return f.pushArray(e),f}if("number"==typeof a.nodeType)return a;if(a.$id&&a.$events)return a;Array.isArray(a.$skipArray)||(a.$skipArray=[]),a.$skipArray.$special=b||{};var g={};c=c||{};var h={},i={},j=[];for(var k in a)!function(b,e){if(c[b]=e,s(b,e,a.$skipArray)){h[b]=[];var f=avalon.type(e),k=function(a){var b=k._name,c=this,d=c.$model,e=d[b],f=c.$events;return arguments.length?void(Ba||(1===k.type||(a=t(k,b,a,c),k.type))&&(yb(e,a)||(d[b]=a,f.$digest?k.pedding||(k.pedding=!0,setTimeout(function(){H(f[b]),v(c,b,d[b],e),k.pedding=!1})):(H(f[b]),v(c,b,a,e))))):0===k.type?(a=k.get.call(c),e!==a&&(d[b]=a,f.$digest?k.pedding||(k.pedding=!0,setTimeout(function(){v(c,b,d[b],e),k.pedding=!1})):v(c,b,a,e)),a):(C(f[b]),k.svmodel||e)};"object"===f&&Ta(e.get)&&Object.keys(e).length<=2?(k.set=e.set,k.get=e.get,k.type=0,j.push(function(){var a={evaluator:function(){a.type=Math.random(),a.element=null,c[b]=k.get.call(g)},element:va,type:Math.random(),handler:d,args:[]};La[ta]=a,k.call(g),delete La[ta]})):Da.test(f)?(k.type=2,k.valueType=f,j.push(function(){var a=u(e,0,c[b]);k.svmodel=a,a.$events[ya]=h[b]})):k.type=1,k._name=b,i[b]=k}}(k,a[k]);tb.forEach(function(b){delete a[b],delete c[b]}),g=xb(g,zb(i),a);for(var l in a)i[l]||(g[l]=a[l]);g.$id=Ra(),g.$model=c,g.$events=h;for(k in pb){var m=pb[k];Ma||(m=m.bind(g)),g[k]=m}return wb?Object.defineProperty(g,"hasOwnProperty",{value:function(a){return a in this.$model},writable:!1,enumerable:!1,configurable:!0}):g.hasOwnProperty=function(a){return a in g.$model},j.forEach(function(a){a()}),g}function v(a,b,c,d){a.$events&&pb.$fire.call(a,b,c,d)}function w(a,b,c,d){var e=a[b];if("array"===d)return Array.isArray(c)&&e!==c?(e._.$unwatch(),e.clear(),e._.$watch(),e.pushArray(c.concat()),e):e;var f=a.$events[b],g=e.$events.$withProxyPool;g&&(qa(g,"with"),e.$events.$withProxyPool=null);var h=u(c);return h.$events[ya]=f,ub[h.$id]=function(a){for(;a=f.shift();)!function(a){avalon.nextTick(function(){a.type&&(a.rollback&&a.rollback(),Wa[a.type](a,a.vmodels))})}(a);delete ub[h.$id]},h}function x(a,b,c,d){var e=b[c];return 4!==arguments.length?e.call(a):void e.call(a,d)}function y(a){var b=[];b.$id=Ra(),b.$model=a,b.$events={},b.$events[ya]=[],b._=u({length:a.length}),b._.$watch("length",function(a,c){b.$fire("length",a,c)});for(var c in pb)b[c]=pb[c];return avalon.mix(b,Bb),b}function z(a,b,c,d,e,f,g){for(var h=this.length,i=2;--i;){switch(a){case"add":var j=this.$model.slice(b,b+c).map(function(a){return Da.test(avalon.type(a))?a.$id?a:u(a,0,a):a});Ab.apply(this,[b,0].concat(j)),this._fire("add",b,c);break;case"del":var k=this._splice(b,c);this._fire("del",b,c)}e&&(a=e,b=f,c=g,i=2,e=0)}return this._fire("index",d),this.length!==h&&(this._.length=this.length),k}function A(a,b){for(var c={},d=0,e=b.length;d<e;d++){c[d]=a[d];var f=b[d];f in c?(a[d]=c[f],delete c[f]):a[d]=a[f]}}function B(a){La[ta]=a,avalon.openComputedCollect=!0;var b=a.evaluator;if(b)try{var c=Cb.test(a.type)?a:b.apply(0,a.args);a.handler(c,a.element,a)}catch(b){delete a.evaluator;var d=a.element;if(3===d.nodeType){var e=d.parentNode;q.commentInterpolate?e.replaceChild(ua.createComment(a.value),d):d.data=hb+a.value+ib}}avalon.openComputedCollect=!1,delete La[ta]}function C(a){var b=La[ta];a&&b&&avalon.Array.ensure(a,b)&&b.element&&D(b,a)}function D(a,b){a.$uuid=a.$uuid||Ra(),b.$uuid=b.$uuid||Ra();var c={data:a,list:b,$$uuid:a.$uuid+b.$uuid};Db[c.$$uuid]||(Db[c.$$uuid]=1,Db.push(c))}function E(a){a.element=null,a.rollback&&a.rollback();for(var b in a)a[b]=null}function F(a){try{if(!a.parentNode)return!0}catch(a){return!0}return a.msRetain?0:1===a.nodeType?"number"==typeof a.sourceIndex?0===a.sourceIndex:!Na.contains(a):!avalon.contains(Na,a)}function G(){for(var a,b=Db.length,c=b,d=0,e=[],f={},g={};a=Db[--b];){var h=a.data,i=h.type;f[i]?f[i]++:(f[i]=1,e.push(i))}var j=!1;if(e.forEach(function(a){Fb[a]!==f[a]&&(g[a]=1,j=!0)}),b=c,j)for(;a=Db[--b];)h=a.data,void 0!==h.element&&g[h.type]&&F(h.element)&&(d++,Db.splice(b,1),delete Db[a.$$uuid],avalon.Array.remove(a.list,h),E(h),a.data=a.list=null);Fb=f,Eb=new Date}function H(a){if(a&&a.length){new Date-Eb>444&&"object"==typeof a[0]&&G();for(var b,c=Ka.call(arguments,1),e=a.length;b=a[--e];){var f=b.element;if(f&&f.parentNode)if(b.$repeat)b.handler.apply(b,c);else if("on"!==b.type){var g=b.evaluator||d;b.handler(g.apply(0,b.args||[]),f,b)}}}}function I(a){var b=a.nodeName;return b.toLowerCase()===b&&a.scopeName&&""===a.outerText}function J(a){"url(#default#VML)"!==a.currentStyle.behavior&&(a.style.behavior="url(#default#VML)",a.style.display="inline-block",a.style.zoom=1)}function K(a,b,c){var d=setTimeout(function(){var e=a.innerHTML;clearTimeout(d),e===c?b():K(a,b,e)})}function L(a,b){var c=a.getAttribute("avalonctrl")||b.$id;a.setAttribute("avalonctrl",c),b.$events.expr=a.tagName+'[avalonctrl="'+c+'"]'}function M(a,b){for(var c,d=0;c=a[d++];)c.vmodels=b,Wa[c.type](c,b),c.evaluator&&c.element&&1===c.element.nodeType&&c.element.removeAttribute(c.name);a.length=0}function N(a,b){return a.priority-b.priority}function O(a,b){for(var d,e,f=_b?_b(a):avalon.slice(a.attributes),g=[],h={},i=0;e=f[i++];)if(e.specified&&(d=e.name.match(Qb))){var j=d[1],k=d[2]||"",l=e.value,m=e.name;if(h[m]=l,Sb[j]?(k=j,j="on"):Tb[j]&&(c("ms-"+j+"已经被废弃,请使用ms-attr-*代替"),"enabled"===j&&(j="disabled",l="!("+l+")"),k=j,j="attr",a.removeAttribute(m),m="ms-attr-"+k,a.setAttribute(m,l),d=[m],h[m]=l),"function"==typeof Wa[j]){var n={type:j,param:k,element:a,name:d[0],value:l,priority:j in Rb?Rb[j]:10*j.charCodeAt(0)+(Number(k)||0)};if("html"===j||"text"===j){var o=T(l);avalon.mix(n,o),n.filters=n.filters.replace(ac,function(){return n.type="html",n.group=1,""})}"ms-if-loop"===m&&(n.priority+=100),b.length&&(g.push(n),"widget"===j&&(a.msData=a.msData||h))}}g.sort(N),h["ms-attr-checked"]&&h["ms-duplex"]&&c("warning!一个元素上不能同时定义ms-attr-checked与ms-duplex");var p=!0;for(i=0;n=g[i];i++){if(j=n.type,Ub.test(j))return M(g.slice(0,i+1),b);p&&(p=!Vb.test(j))}M(g,b),p&&!Nb[a.tagName]&&lb.test(a.innerHTML.replace(cc,"<").replace(dc,">"))&&(Pb&&Pb(a),P(a,b))}function P(a,b){for(var c=a.firstChild;c;){var d=c.nextSibling;R(c,c.nodeType,b),c=d}}function Q(a,b){for(var c,d=0;c=a[d++];)R(c,c.nodeType,b)}function R(a,b,c){1===b?S(a,c):3===b&&jb.test(a.data)?V(a,c):q.commentInterpolate&&8===b&&!jb.test(a.nodeValue)&&V(a,c)}function S(a,b,d){var e=a.getAttribute("ms-skip");if(!a.getAttributeNode)return c("warning "+a.tagName+" no getAttributeNode method");var f=a.getAttributeNode("ms-important"),g=a.getAttributeNode("ms-controller");if("string"!=typeof e){if(d=f||g){var h=avalon.vmodels[d.value];if(!h)return;b=d===f?[h]:[h].concat(b);var i=d.name;a.removeAttribute(i),avalon(a).removeClass(i),L(a,h)}O(a,b)}}function T(a){if(a.indexOf("|")>0){var b=a.replace(rstringLiteral,function(a){return Math.pow(10,a.length)}),c=b.replace(bc,"ᄢ㍄").indexOf("|");if(c>-1)return{filters:a.slice(c),value:a.slice(0,c),expr:!0}}return{value:a,filters:"",expr:!0}}function U(a){for(var b,c,d=[],e=0;(c=a.indexOf(hb,e),c!==-1)&&(b=a.slice(e,c),b&&d.push({value:b,filters:"",expr:!1}),e=c+hb.length,c=a.indexOf(ib,e),c!==-1);)b=a.slice(e,c),b&&d.push(T(b)),e=c+ib.length;return b=a.slice(e),b&&d.push({value:b,expr:!1,filters:""}),d}function V(a,b){var c=[];if(8===a.nodeType)var d=T(a.nodeValue),e=[d];else e=U(a.data);if(e.length){for(var f=0;d=e[f++];){var g=ua.createTextNode(d.value);d.expr&&(d.type="text",d.element=g,d.filters=d.filters.replace(ac,function(){return d.type="html",d.group=1,""}),c.push(d)),Oa.appendChild(g)}a.parentNode.replaceChild(Oa,a),c.length&&M(c,b)}}function W(a){return a.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function X(a){return a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})}function Y(a){if(!("classList"in a)){a.classList={node:a};for(var b in ec)a.classList[b.slice(1)]=ec[b]}return a.classList}function Z(a){try{if("object"==typeof a)return a;a="true"===a||"false"!==a&&("null"===a?null:+a+""===a?+a:fc.test(a)?avalon.parseJSON(a):a)}catch(a){}return a}function $(a){return a.window&&a.document?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}function _(a,b){if(a.offsetWidth<=0){if(uc.test(kc["@:get"](a,"display"))){var c={node:a};for(var d in tc)c[d]=a.style[d],a.style[d]=tc[d];b.push(c)}var e=a.parentNode;e&&1===e.nodeType&&_(e,b)}}function aa(a){var b=a.tagName.toLowerCase();return"input"===b&&/checkbox|radio/.test(a.type)?"checked":b}function ba(a,b,c,d){for(var e,f=[],g=" = "+c+".",h=a.length;e=a[--h];)b.hasOwnProperty(e)&&(f.push(e+g+e),d.vars.push(e),"duplex"===d.type&&(a.get=c+"."+e),a.splice(h,1));return f}function ca(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e&&"string"==typeof e.$id?e.$id:e;c[f]||(c[f]=b.push(e))}return b}function da(a,b){return b=b.replace(Kc,"").replace(Lc,function(){return"],|"}).replace(Mc,function(a,b){return"["+yc(b)}).replace(Nc,function(){return'"],["'}).replace(Oc,function(){return'",'})+"]","return avalon.filters.$filter("+a+", "+b+")"}function ea(a,b,e){var f=e.type,g=e.filters||"",h=b.map(function(a){return String(a.$id).replace(Jc,"$1")})+a+f+g,i=Gc(a).concat(),j=[],k=[],l=[],m="";b=ca(b),e.vars=[];for(var n=0,o=b.length;n<o;n++)if(i.length){var p="vm"+ta+"_"+n;k.push(p),l.push(b[n]),j.push.apply(j,ba(i,b[n],p,e))}if(j.length||"duplex"!==f){"duplex"!==f&&(a.indexOf("||")>-1||a.indexOf("&&")>-1)&&e.vars.forEach(function(b){var c=new RegExp("\\b"+b+"(?:\\.\\w+|\\[\\w+\\])+","ig");a=a.replace(c,function(c){var d=c.charAt(b.length),e=Sa?a.slice(arguments[1]+c.length):RegExp.rightContext,f=/^\s*\(/.test(e);if("."===d||"["===d||f){var g="var"+String(Math.random()).replace(/^0\./,"");if(f){var h=c.split(".");if(h.length>2){var i=h.pop();return j.push(g+" = "+h.join(".")),g+"."+i}return c}return j.push(g+" = "+c),g}return c})}),e.args=l;var q=Hc[h];if(q)return void(e.evaluator=q);if(m=j.join(", "),m&&(m="var "+m),/\S/.test(g)){if(!/text|html/.test(e.type))throw Error("ms-"+e.type+"不支持过滤器");a="\nvar ret"+ta+" = "+a+";\r\n",a+=da("ret"+ta,g)}else{if("duplex"===f){var r="'use strict';\nreturn function(vvv){\n\t"+m+";\n\tif(!arguments.length){\n\t\treturn "+a+"\n\t}\n\t"+(Ic.test(a)?a:i.get)+"= vvv;\n} ";try{q=Function.apply(d,k.concat(r)),e.evaluator=Hc(h,q)}catch(a){c("debug: parse error,"+a.message)}return}if("on"===f){a.indexOf("(")===-1?a+=".call(this, $event)":a=a.replace("(",".call(this,"),k.push("$event"),a="\nreturn "+a+";";var s=a.lastIndexOf("\nreturn"),t=a.slice(0,s),u=a.slice(s);a=t+"\n"+u}else a="\nreturn "+a+";"}try{q=Function.apply(d,k.concat("'use strict';\n"+m+a)),e.evaluator=Hc(h,q)}catch(a){c("debug: parse error,"+a.message)}finally{i=textBuffer=k=null}}}function fa(a,b,c,d,e){Array.isArray(d)&&(a=d.map(function(a){return a.expr?"("+a.value+")":yc(a.value)}).join(" + ")),ea(a,b,c),c.evaluator&&!e&&(c.handler=Xa[c.handlerName||c.type],B(c))}function ga(a){return null==a?"":a}function ha(a,b,c,d){return b.param.replace(/\w+/g,function(d){var e=avalon.duplexHooks[d];e&&"function"==typeof e[c]&&(a=e[c](a,b))}),a}function ia(){for(var a=Zc.length-1;a>=0;a--){var b=Zc[a];b()===!1&&Zc.splice(a,1)}Zc.length||clearInterval(Yc)}function ja(a,b,c,d){var e=a.template.cloneNode(!0),f=avalon.slice(e.childNodes);c.$stamp&&e.insertBefore(c.$stamp,e.firstChild),b.appendChild(e);var g=[c].concat(a.vmodels),h={nodes:f,vmodels:g};d.push(h)}function ka(a,b){var c=a.proxies[b];return c?c.$stamp:a.element}function la(a,b,c){for(;;){var d=b.previousSibling;if(!d)break;if(d.parentNode.removeChild(d),c&&c.call(d),d===a)break}}function ma(a){var b={$host:[],$outer:{},$stamp:1,$index:0,$first:!1,$last:!1,$remove:avalon.noop};b[a]={get:function(){return this.$host[this.$index]},set:function(a){this.$host.set(this.$index,a)}};var c={$last:1,$first:1,$index:1},d=u(b,c),e=d.$events;return e[a]=e.$first=e.$last=e.$index,d.$id=Ra("$proxy$each"),d}function na(a,b){for(var c,d=b.param||"el",e=0,f=ad.length;e<f;e++){var g=ad[e];g&&g.hasOwnProperty(d)&&(c=g,ad.splice(e,1))}c||(c=ma(d));var h=b.$repeat,i=h.length-1;return c.$index=a,c.$first=0===a,c.$last=a===i,c.$host=h,c.$outer=b.$outer,c.$stamp=b.clone.cloneNode(!1),c.$remove=function(){return h.removeAt(c.$index)},c}function oa(){var a=u({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(a){this.$host[this.$key]=a}}},{$val:1});return a.$id=Ra("$proxy$with"),a}function pa(a,b){var c=bd.pop();c||(c=oa());var d=b.$repeat;return c.$key=a,c.$host=d,c.$outer=b.$outer,d.$events?c.$events.$val=d.$events[a]:c.$events={},c}function qa(a,b){var c="each"===b?ad:bd;avalon.each(a,function(a,b){if(b.$events){for(var d in b.$events)Array.isArray(b.$events[d])&&(b.$events[d].forEach(function(a){"object"==typeof a&&E(a)}),b.$events[d].length=0);b.$host=b.$outer={},c.unshift(b)>q.maxRepeatSize&&c.pop()}}),"each"===b&&(a.length=0)}function ra(a,b){var c="_"+a;if(!ra[c]){var d=ua.createElement(a);Na.appendChild(d),b=Ma?getComputedStyle(d,null).display:d.currentStyle.display,Na.removeChild(d),ra[c]=b}return ra[c]}function sa(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):3,g=d||",",h=c||".",i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)}var ta=new Date-0,ua=a.document,va=ua.getElementsByTagName("head")[0],wa=va.insertBefore(document.createElement("avalon"),va.firstChild);wa.innerHTML="X<style id='avalonStyle'>.avalonHide{ display: none!important }</style>",wa.setAttribute("ms-skip","1"),wa.className="avalonHide";var xa=/\[native code\]/,ya="$"+ta,za=a.require,Aa=a.define,Ba=!1,Ca=/[^, ]+/g,Da=/^(?:object|array)$/,Ea=/^\[object SVG\w*Element\]$/,Fa=/^\[object (?:Window|DOMWindow|global)\]$/,Ga=Object.prototype,Ha=Ga.hasOwnProperty,Ia=Ga.toString,Ja=Array.prototype,Ka=Ja.slice,La={},Ma=a.dispatchEvent,Na=ua.documentElement,Oa=ua.createDocumentFragment(),Pa=ua.createElement("div"),Qa={};"Boolean Number String Function Array Date RegExp Object Error".replace(Ca,function(a){Qa["[object "+a+"]"]=a.toLowerCase()});var Ra=function(a){return a=a||"avalon",(a+Math.random()+Math.random()).replace(/0\./g,"")},Sa=g();avalon=function(a){return new avalon.init(a)},avalon.init=function(a){this[0]=this.element=a},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?Qa[Ia.call(a)]||"object":typeof a};var Ta="object"==typeof alert?function(a){try{return/^\s*\bfunction\b/.test(a+"")}catch(a){return!1}}:function(a){return"[object Function]"===Ia.call(a)};avalon.isFunction=Ta,avalon.isWindow=function(a){return!!a&&a==a.document&&a.document!=a},h(a)&&(avalon.isWindow=h);var Ua;for(Ua in avalon({}))break;var Va="0"!==Ua;avalon.isPlainObject=function(a,b){if(!a||"object"!==avalon.type(a)||a.nodeType||avalon.isWindow(a))return!1;try{if(a.constructor&&!Ha.call(a,"constructor")&&!Ha.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}if(Va)for(b in a)return Ha.call(a,b);for(b in a);return void 0===b||Ha.call(a,b)},xa.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(a){return"[object Object]"===Ia.call(a)&&Object.getPrototypeOf(a)===Ga}),avalon.mix=avalon.fn.mix=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h++),"object"==typeof g||Ta(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a){c=g[b];try{d=a[b]}catch(a){continue}g!==d&&(j&&d&&(avalon.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&avalon.isPlainObject(c)?c:{},g[b]=avalon.mix(j,f,d)):void 0!==d&&(g[b]=d))}return g},avalon.mix({rword:Ca,subscribers:ya,version:1.4,ui:{},log:c,slice:Ma?function(a,b,c){return Ka.call(a,b,c)}:function(a,b,c){var d=[],e=a.length;if(void 0===c&&(c=e),"number"==typeof c&&isFinite(c)){b=i(b,e),c=i(c,e);for(var f=b;f<c;++f)d[f-b]=a[f]}return d},noop:d,error:function(a,b){throw new(b||Error)(a)},oneObject:e,range:function(a,b,c){c||(c=1),null==b&&(b=a||0,a=0);for(var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a,a+=c;return f},eventHooks:{},bind:function(a,b,c,d){var e=avalon.eventHooks,f=e[b];"object"==typeof f&&(b=f.type,f.deel&&(c=f.deel(a,c)));var g=Ma?c:function(b){c.call(a,p(b))};return Ma?a.addEventListener(b,g,!!d):a.attachEvent("on"+b,g),g},unbind:function(a,b,c,e){var f=avalon.eventHooks,g=f[b],h=c||d;"object"==typeof g&&(b=g.type),Ma?a.removeEventListener(b,h,!!e):a.detachEvent("on"+b,h)},css:function(a,b,c){a instanceof avalon&&(a=a[0]);var d,e=/[_-]/.test(b)?X(b):b;if(b=avalon.cssName(e)||e,void 0===c||"boolean"==typeof c){d=kc[e+":get"]||kc["@:get"],"background"===b&&(b="backgroundColor");var f=d(a,b);return c===!0?parseFloat(f)||0:f}if(""===c)a.style[b]="";else{if(null==c||c!==c)return;isFinite(c)&&!avalon.cssNumber[e]&&(c+="px"),(d=kc[e+":set"]||kc["@:set"])(a,b,c)}},each:function(a,b){if(a){var c=0;if(j(a))for(var d=a.length;c<d&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break}},getWidgetData:function(a,b){var c=avalon(a).data(),d={};for(var e in c)0===e.indexOf(b)&&(d[e.replace(b,"").replace(/\w/,function(a){return a.toLowerCase()})]=c[e]);return d},Array:{ensure:function(a,b){if(a.indexOf(b)===-1)return a.push(b)},removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return!!~c&&avalon.Array.removeAt(a,c)}}});var Wa=avalon.bindingHandlers={},Xa=avalon.bindingExecutors={};if(avalon.nextTick=a.setImmediate?setImmediate.bind(a):function(a){setTimeout(a,0)},!"司徒正美".trim){var Ya=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(Ya,"")}}var Za=!{toString:null}.propertyIsEnumerable("toString"),$a=function(){}.propertyIsEnumerable("prototype"),_a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ab=_a.length;if(Object.keys||(Object.keys=function(a){var b=[],c=$a&&"function"==typeof a;if("string"==typeof a||a&&a.callee)for(var d=0;d<a.length;++d)b.push(String(d));else for(var e in a)c&&"prototype"===e||!Ha.call(a,e)||b.push(String(e));if(Za)for(var f=a.constructor,g=f&&f.prototype===a,h=0;h<ab;h++){var i=_a[h];g&&"constructor"===i||!Ha.call(a,i)||b.push(i)}return b}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Ia.call(a)}),d.bind||(Function.prototype.bind=function(a){if(arguments.length<2&&void 0===a)return this;var b=this,c=arguments;return function(){var d,e=[];for(d=1;d<c.length;d++)e.push(c[d]);for(d=0;d<arguments.length;d++)e.push(arguments[d]);return b.apply(a,e)}}),xa.test([].map)||avalon.mix(Ja,{indexOf:function(a,b){var c=this.length,d=~~b;for(d<0&&(d+=c);d<c;d++)if(this[d]===a)return d;return-1},lastIndexOf:function(a,b){var c=this.length,d=null==b?c-1:b;for(d<0&&(d=Math.max(0,c+d));d>=0;d--)if(this[d]===a)return d;return-1},forEach:k("","_",""),filter:k("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:k("r=[],","r[i]=_","return r"),some:k("","if(_)return true","return false"),every:k("","if(!_)return false","return true")}),avalon.contains=l,Na.contains||(Node.prototype.contains=function(a){return!!(16&this.compareDocumentPosition(a))}),ua.contains||(ua.contains=function(a){return l(ua,a)}),a.SVGElement){var bb="http://www.w3.org/2000/svg",cb=ua.createElementNS(bb,"svg");cb.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',Ea.test(cb.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:m,set:function(a){var b=this.tagName.toLowerCase(),c=this.parentNode,d=avalon.parseHTML(a);if("svg"===b)c.insertBefore(d,this);else{var e=ua.createDocumentFragment();o(d,e),c.insertBefore(e,this)}c.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var a=this.outerHTML,b=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),c=new RegExp("</"+this.nodeName+">$","i");return a.replace(b,"").replace(c,"")},set:function(a){if(avalon.clearHTML){avalon.clearHTML(this);var b=avalon.parseHTML(a);o(b,this)}}}})}!Na.outerHTML&&a.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",m);var db=/^(?:mouse|contextmenu|drag)|click/,eb=avalon.eventHooks;if("onmouseenter"in Na||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){eb[a]={type:b,deel:function(b,c){return function(d){var e=d.relatedTarget;if(!e||e!==b&&!(16&b.compareDocumentPosition(e)))return delete d.type,d.type=a,c.call(b,d)}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(b,c){a[b]&&!eb.animationend&&(eb.animationend={type:c})}),"oninput"in ua.createElement("input")||(eb.input={type:"propertychange",deel:function(a,b){return function(c){if("value"===c.propertyName)return c.type="input",b.call(a,c)}}}),void 0===ua.onmousewheel){var fb=void 0!==ua.onwheel?"wheel":"DOMMouseScroll",gb="wheel"===fb?"deltaY":"detail";eb.mousewheel={type:fb,deel:function(a,b){return function(c){c.wheelDeltaY=c.wheelDelta=c[gb]>0?-120:120,c.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(c,"type",{value:"mousewheel"}),b.call(a,c)}}}}var hb,ib,jb,kb,lb,mb=/[-.*+?^${}()|[\]\/\\]/g,nb=d,ob={loader:function(b){a.define=b?nb.define:Aa,a.require=b?nb:za},interpolate:function(a){if(hb=a[0],ib=a[1],hb===ib)throw new SyntaxError("openTag!==closeTag");if(a+""=="<!--,-->")q.commentInterpolate=!0;else{var b=hb+"test"+ib;if(Pa.innerHTML=b,Pa.innerHTML!==b&&Pa.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");Pa.innerHTML=""}var c=r(hb),d=r(ib);jb=new RegExp(c+"(.*?)"+d),kb=new RegExp(c+"(.*?)"+d,"g"),lb=new RegExp(c+".*?"+d+"|\\sms-")}};q.debug=!0,q.plugins=ob,q.plugins.interpolate(["{{","}}"]),q.paths={},q.shim={},q.maxRepeatSize=100,avalon.config=q;var pb={$watch:function(a,b){if("function"==typeof b){var c=this.$events[a];c?c.push(b):this.$events[a]=[b]}else this.$events=this.$watch.backup;return this},$unwatch:function(a,b){var c=arguments.length;if(0===c)this.$watch.backup=this.$events,this.$events={};else if(1===c)this.$events[a]=[];else for(var d=this.$events[a]||[],e=d.length;~--e<0;)if(d[e]===b)return d.splice(e,1);return this},$fire:function(a){var b,c,d,e;/^(\w+)!(\S+)$/.test(a)&&(b=RegExp.$1,a=RegExp.$2);var f=this.$events;if(f){var g=Ka.call(arguments,1),h=[a].concat(g);if("all"===b)for(c in avalon.vmodels)d=avalon.vmodels[c],d!==this&&d.$fire.apply(d,h);else if("up"===b||"down"===b){var i=f.expr?rb(f.expr):[];if(0===i.length)return;for(c in avalon.vmodels)if(d=avalon.vmodels[c],d!==this&&d.$events.expr){var j=rb(d.$events.expr);if(0===j.length)continue;Array.prototype.forEach.call(j,function(a){Array.prototype.forEach.call(i,function(c){var e="down"===b?c.contains(a):a.contains(c);e&&(a._avalon=d)})})}var k=ua.getElementsByTagName("*"),l=[];for(Array.prototype.forEach.call(k,function(a){a._avalon&&(l.push(a._avalon),a._avalon="",a.removeAttribute("_avalon"))}),"up"===b&&l.reverse(),c=0;(e=l[c++])&&e.$fire.apply(e,h)!==!1;);}else{var m=f[a]||[],n=f.$all||[];for(c=0;e=m[c++];)Ta(e)&&e.apply(this,g);for(c=0;e=n[c++];)Ta(e)&&e.apply(this,arguments)}}}},qb=/(\w+)\[(avalonctrl)="(\S+)"\]/,rb=ua.querySelectorAll?function(a){return ua.querySelectorAll(a)}:function(a){for(var b,c=a.match(qb),d=ua.getElementsByTagName(c[1]),e=[],f=0;b=d[f++];)b.getAttribute(c[2])===c[3]&&e.push(b);return e},sb=avalon.vmodels={};avalon.define=function(a,b){var e=a.$id||a;if(e||c("warning: vm必须指定$id"),sb[e]&&c("warning: "+e+" 已经存在于avalon.vmodels中"),"object"==typeof a)var f=u(a);else{var g={$watch:d};b(g),f=u(g),Ba=!0,b(f),Ba=!1}return f.$id=e,sb[e]=f};var tb=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray").match(Ca),ub={},vb=Object.defineProperty,wb=!0;try{vb({},"_",{value:"x"});var xb=Object.defineProperties}catch(a){wb=!1}var yb=Object.is||function(a,b){return 0===a&&0===b?1/a===1/b:a!==a?b!==b:a===b},zb=Ma?function(a){var b={};for(var c in a)b[c]={get:a[c],set:a[c],enumerable:!0,configurable:!0};return b}:function(a){return a};wb||("__defineGetter__"in avalon&&(vb=function(a,b,c){return"value"in c&&(a[b]=c.value),"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),a},xb=function(a,b){for(var c in b)b.hasOwnProperty(c)&&vb(a,c,b[c]);return a}),Sa&&(a.execScript(["Function parseVB(code)","\tExecuteGlobal(code)","End Function","Dim VBClassBodies",'Set VBClassBodies=CreateObject("Scripting.Dictionary")',"Function findOrDefineVBClass(name,body)","\tDim found",'\tfound=""',"\tFor Each key in VBClassBodies","\t\tIf body=VBClassBodies.Item(key) Then","\t\t\tfound=key","\t\t\tExit For","\t\tEnd If","\tnext",'\tIf found="" Then','\t\tparseVB("Class " + name + body)',"\t\tVBClassBodies.Add name, body","\t\tfound=name","\tEnd If","\tfindOrDefineVBClass=found","End Function"].join("\n"),"VBScript"),xb=function(b,c,d){var e="VBClass"+setTimeout("1"),f=[];f.push("\r\n\tPrivate [__data__], [__proxy__]","\tPublic Default Function [__const__](d, p)","\t\tSet [__data__] = d: set [__proxy__] = p","\t\tSet [__const__] = Me","\tEnd Function");for(b in d)c.hasOwnProperty(b)||f.push("\tPublic ["+b+"]");tb.forEach(function(a){c.hasOwnProperty(a)||f.push("\tPublic ["+a+"]")}),f.push("\tPublic [hasOwnProperty]");for(b in c)f.push("\tPublic Property Let ["+b+"](val"+ta+")",'\t\tCall [__proxy__](Me,[__data__], "'+b+'", val'+ta+")","\tEnd Property","\tPublic Property Set ["+b+"](val"+ta+")",'\t\tCall [__proxy__](Me,[__data__], "'+b+'", val'+ta+")","\tEnd Property","\tPublic Property Get ["+b+"]","\tOn Error Resume Next","\t\tSet["+b+'] = [__proxy__](Me,[__data__],"'+b+'")',"\tIf Err.Number <> 0 Then","\t\t["+b+'] = [__proxy__](Me,[__data__],"'+b+'")',"\tEnd If","\tOn Error Goto 0","\tEnd Property");f.push("End Class");var g=f.join("\r\n"),h=a.findOrDefineVBClass(e,g);h===e&&a.parseVB(["Function "+e+"Factory(a, b)","\tDim o","\tSet o = (New "+e+")(a, b)","\tSet "+e+"Factory = o","End Function"].join("\r\n"));var i=a[h+"Factory"](c,x);return i}));var Ab=Ja.splice,Bb={_splice:Ab,_fire:function(a,b,c){H(this.$events[ya],a,b,c)},size:function(){return this._.length},pushArray:function(a){var b=a.length,c=this.length;return b&&(Ja.push.apply(this.$model,a),z.call(this,"add",c,b,c)),b+c},push:function(){var a,b=[],c=arguments.length;for(a=0;a<c;a++)b[a]=arguments[a];return this.pushArray(arguments)},unshift:function(){var a=arguments.length,b=this.length;return a&&(Ja.unshift.apply(this.$model,arguments),z.call(this,"add",0,a,0)),a+b},shift:function(){if(this.length){var a=this.$model.shift();return z.call(this,"del",0,1,0),a}},pop:function(){var a=this.length;if(a){var b=this.$model.pop();return z.call(this,"del",a-1,1,Math.max(0,a-2)),b}},splice:function(a){var b,c=arguments.length,d=[],e=Ab.apply(this.$model,arguments);return e.length&&(d.push("del",a,e.length,0),b=!0),c>2&&(b?d.splice(3,1,0,"add",a,c-2):d.push("add",a,c-2,0),b=!0),b?z.apply(this,d):[]},contains:function(a){return this.indexOf(a)!==-1},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){return a>=0?(this.$model.splice(a,1),z.call(this,"del",a,1,0)):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(a){if(Array.isArray(a))a.forEach(function(a){this.remove(a)},this);else if("function"==typeof a)for(var b=this.length-1;b>=0;b--){var c=this[b];a(c,b)&&this.removeAt(b)}else this.clear()},ensure:function(a){return this.contains(a)||this.push(a),this},set:function(a,b){if(a>=0){var c=avalon.type(b);b&&b.$model&&(b=b.$model);var d=this[a];if("object"===c)for(var e in b)d.hasOwnProperty(e)&&(d[e]=b[e]);else"array"===c?d.clear().push.apply(d,b):d!==b&&(this[a]=b,this.$model[a]=b,this._fire("set",a,b))}return this}};"sort,reverse".replace(Ca,function(a){Bb[a]=function(){var b,c=this.$model,d=c.concat(),e=Math.random(),f=[];Ja[a].apply(c,arguments);for(var g=0,h=d.length;g<h;g++){var i=c[g],j=d[g];if(yb(i,j))f.push(g);else{var k=d.indexOf(i);f.push(k),d[k]=e,b=!0}}return b&&(A(this,f),this._fire("move",f),this._fire("index",0)),this}});var Cb=/^(duplex|on)$/,Db=avalon.$$subscribers=[],Eb=new Date,Fb={},Gb={area:[1,"<map>"],param:[1,"<object>"],col:[2,"<table><tbody></tbody><colgroup>","</table>"],legend:[1,"<fieldset>"],option:[1,"<select multiple='multiple'>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],td:[3,"<table><tbody><tr>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:Ma?[0,""]:[1,"X<div>"]};Gb.optgroup=Gb.option,Gb.tbody=Gb.tfoot=Gb.colgroup=Gb.caption=Gb.thead,String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(Ca,function(a){Gb[a]=Gb.g});var Hb=/<([\w:]+)/,Ib=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Jb=Ma?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,Kb=e(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),Lb=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,Mb=ua.createElement("script");
avalon.parseHTML=function(a){if("string"!=typeof a)return ua.createDocumentFragment();a=a.replace(Ib,"<$1></$2>").trim();var b,c,d=(Hb.exec(a)||["",""])[1].toLowerCase(),e=Gb[d]||Gb._default,f=Oa.cloneNode(!1),g=Pa;Ma||(a=a.replace(Jb,"<br class=msNoScope>$1")),g.innerHTML=e[1]+a+(e[2]||"");var h=g.getElementsByTagName("script");if(h.length)for(var i,j=0;i=h[j++];)Kb[i.type]&&(c=Mb.cloneNode(!1),Ja.forEach.call(i.attributes,function(a){a&&a.specified&&(c[a.name]=a.value,c.setAttribute(a.name,a.value))}),c.text=i.text,i.parentNode.replaceChild(c,i));for(j=e[0];j--;g=g.lastChild);if(!Ma){for(h=g.getElementsByTagName("br"),n=h.length;i=h[--n];)"msNoScope"===i.className&&i.parentNode.removeChild(i);for(h=g.all,j=0;i=h[j++];)I(i)&&J(i)}for(;b=g.firstChild;)f.appendChild(b);return f},avalon.innerHTML=function(a,b){if(!Ma&&!Jb.test(b)&&!Lb.test(b))try{return void(a.innerHTML=b)}catch(a){}var c=this.parseHTML(b);this.clearHTML(a).appendChild(c)},avalon.clearHTML=function(a){for(a.textContent="";a.firstChild;)a.removeChild(a.firstChild);return a},avalon.scan=function(a,b,c){a=a||Na;var d=b?[].concat(b):[];S(a,d)};var Nb=e("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),Ob=function(a,b,c){var d=a.getAttribute(b);if(d)for(var e,f=0;e=c[f++];)if(e.hasOwnProperty(d)&&"function"==typeof e[d])return e[d]},Pb=Sa&&a.MutationObserver?function(a){for(var b,c=a.firstChild;c;){var d=c.nextSibling;3===c.nodeType?b?(b.nodeValue+=c.nodeValue,a.removeChild(c)):b=c:b=null,c=d}}:0,Qb=/ms-(\w+)-?(.*)/,Rb={if:10,repeat:90,data:100,widget:110,each:1400,with:1500,duplex:2e3,on:3e3},Sb=e("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),Tb=e("value,title,alt,checked,selected,disabled,readonly,enabled"),Ub=/^if|widget|repeat$/,Vb=/^each|with|html|include$/;if(!"1"[0])var Wb=f(512),Xb=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,Yb=/^['"]/,Zb=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,$b=/&amp;/g,_b=function(a){var b=a.outerHTML;if("</"===b.slice(0,2)||!b.trim())return[];var c,d,e,f=b.match(Zb)[0],g=[];if(Wb[f])return Wb[f];for(;d=Xb.exec(f);){e=d[2],e&&(e=(Yb.test(e)?e.slice(1,-1):e).replace($b,"&"));var h=d[1].toLowerCase();c=h.match(Qb);var i={name:h,specified:!0,value:e||""};g.push(i)}return Wb(f,g)};var ac=/\|\s*html\s*/,bc=/\|\|/g,cc=/&lt;/g,dc=/&gt;/g;rstringLiteral=/(['"])(\\\1|.)+?\1/g;var ec={_toString:function(){var a=this.node,b=a.className,c="string"==typeof b?b:b.baseVal;return c.split(/\s+/).join(" ")},_contains:function(a){return(" "+this+" ").indexOf(" "+a+" ")>-1},_add:function(a){this.contains(a)||this._set(this+" "+a)},_remove:function(a){this._set((" "+this+" ").replace(" "+a+" "," "))},__set:function(a){a=a.trim();var b=this.node;Ea.test(b)?b.setAttribute("class",a):b.className=a}};"add,remove".replace(Ca,function(a){avalon.fn[a+"Class"]=function(b){var c=this[0];return b&&"string"==typeof b&&c&&1===c.nodeType&&b.replace(/\S+/g,function(b){Y(c)[a](b)}),this}}),avalon.fn.mix({hasClass:function(a){var b=this[0]||{};return 1===b.nodeType&&Y(b).contains(a)},toggleClass:function(a,b){for(var c,d=0,e=a.split(/\s+/),f="boolean"==typeof b;c=e[d++];){var g=f?b:!this.hasClass(c);this[g?"addClass":"removeClass"](c)}return this},attr:function(a,b){return 2===arguments.length?(this[0].setAttribute(a,b),this):this[0].getAttribute(a)},data:function(a,b){switch(a="data-"+W(a||""),arguments.length){case 2:return this.attr(a,b),this;case 1:var c=this.attr(a);return Z(c);case 0:var d={};return Ja.forEach.call(this[0].attributes,function(b){b&&(a=b.name,a.indexOf("data-")||(a=X(a.slice(5)),d[a]=Z(b.value)))}),d}},removeData:function(a){return a="data-"+W(a),this[0].removeAttribute(a),this},css:function(a,b){if(avalon.isPlainObject(a))for(var c in a)avalon.css(this,c,a[c]);else var d=avalon.css(this,a,b);return void 0!==d?d:this},position:function(){var a,b,c=this[0],d={top:0,left:0};if(c)return"fixed"===this.css("position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),"HTML"!==a[0].tagName&&(d=a.offset()),d.top+=avalon.css(a[0],"borderTopWidth",!0),d.left+=avalon.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-avalon.css(c,"marginTop",!0),left:b.left-d.left-avalon.css(c,"marginLeft",!0)}},offsetParent:function(){for(var a=this[0].offsetParent;a&&"static"===avalon.css(a,"position");)a=a.offsetParent;return avalon(a||Na)},bind:function(a,b,c){if(this[0])return avalon.bind(this[0],a,b,c)},unbind:function(a,b,c){return this[0]&&avalon.unbind(this[0],a,b,c),this},val:function(a){var b=this[0];if(b&&1===b.nodeType){var c=0===arguments.length,d=c?":get":":set",e=wc[aa(b)+d];if(e)var f=e(b,a);else{if(c)return(b.value||"").replace(/\r/g,"");b.value=a}}return c?f:this}});var fc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,gc=/^[\],:{}\s]*$/,hc=/(?:^|:|,)(?:\s*\[)+/g,ic=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,jc=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=a.JSON?JSON.parse:function(a){if("string"==typeof a){if(a=a.trim(),a&&gc.test(a.replace(ic,"@").replace(jc,"]").replace(hc,"")))return new Function("return "+a)();avalon.error("Invalid JSON: "+a)}return a},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){avalon.fn[a]=function(c){var d=this[0]||{},e=$(d),f="scrollTop"===a;return arguments.length?void(e?e.scrollTo(f?avalon(e).scrollLeft():c,f?c:avalon(e).scrollTop()):d[a]=c):e?b in e?e[b]:Na[a]:d[a]}});var kc=avalon.cssHooks={},lc=["","-webkit-","-o-","-moz-","-ms-"],mc={float:Ma?"cssFloat":"styleFloat"};if(avalon.cssNumber=e("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(a,b,c){if(mc[a])return mc[a];b=b||Na.style;for(var d=0,e=lc.length;d<e;d++)if(c=X(lc[d]+a),c in b)return mc[a]=c;return null},kc["@:set"]=function(a,b,c){try{a.style[b]=c}catch(a){}},a.getComputedStyle)kc["@:get"]=function(a,b){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var c,d=getComputedStyle(a,null);return d&&(c="filter"===b?d.getPropertyValue(b):d[b],""===c&&(c=a.style[b])),c},kc["opacity:get"]=function(a){var b=kc["@:get"](a,"opacity");return""===b?"1":b};else{var nc=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,oc=/^(top|right|bottom|left)$/,pc=/alpha\([^)]*\)/i,qc=!!a.XDomainRequest,rc="DXImageTransform.Microsoft.Alpha",sc={thin:qc?"1px":"2px",medium:qc?"3px":"4px",thick:qc?"5px":"6px"};kc["@:get"]=function(a,b){var c=a.currentStyle,d=c[b];if(nc.test(d)&&!oc.test(d)){var e=a.style,f=e.left,g=a.runtimeStyle.left;a.runtimeStyle.left=c.left,e.left="fontSize"===b?"1em":d||0,d=e.pixelLeft+"px",e.left=f,a.runtimeStyle.left=g}return"medium"===d&&(b=b.replace("Width","Style"),"none"===c[b]&&(d="0px")),""===d?"auto":sc[d]||d},kc["opacity:set"]=function(a,b,c){var d=a.style,e=isFinite(c)&&c<=1?"alpha(opacity="+100*c+")":"",f=d.filter||"";d.zoom=1,d.filter=(pc.test(f)?f.replace(pc,e):f+" "+e).trim(),d.filter||d.removeAttribute("filter")},kc["opacity:get"]=function(a){var b=a.filters.alpha||a.filters[rc],c=b&&b.enabled?b.opacity:100;return c/100+""}}"top,left".replace(Ca,function(a){kc[a+":get"]=function(b){var c=kc["@:get"](b,a);return/px$/.test(c)?c:avalon(b).position()[a]+"px"}});var tc={position:"absolute",visibility:"hidden",display:"block"},uc=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(Ca,function(a){var b=a.toLowerCase(),c="client"+a,d="scroll"+a,e="offset"+a;kc[b+":get"]=function(b,c,d){var f=-4;"number"==typeof d&&(f=d),c="Width"===a?["Left","Right"]:["Top","Bottom"];var g=b[e];return 2===f?g+avalon.css(b,"margin"+c[0],!0)+avalon.css(b,"margin"+c[1],!0):(f<0&&(g=g-avalon.css(b,"border"+c[0]+"Width",!0)-avalon.css(b,"border"+c[1]+"Width",!0)),f===-4&&(g=g-avalon.css(b,"padding"+c[0],!0)-avalon.css(b,"padding"+c[1],!0)),g)},kc[b+"&get"]=function(a){var c=[];_(a,c);for(var d,e=kc[b+":get"](a),f=0;d=c[f++];){a=d.node;for(var g in d)"string"==typeof d[g]&&(a.style[g]=d[g])}return e},avalon.fn[b]=function(f){var g=this[0];if(0===arguments.length){if(g.setTimeout)return g["inner"+a]||g.document.documentElement[c];if(9===g.nodeType){var h=g.documentElement;return Math.max(g.body[d],h[d],g.body[e],h[e],h[c])}return kc[b+"&get"](g)}return this.css(b,f)},avalon.fn["inner"+a]=function(){return kc[b+":get"](this[0],void 0,-2)},avalon.fn["outer"+a]=function(a){return kc[b+":get"](this[0],void 0,a===!0?2:0)}}),avalon.fn.offset=function(){var a=this[0],b={left:0,top:0};if(!a||!a.tagName||!a.ownerDocument)return b;var c=a.ownerDocument,d=c.body,e=c.documentElement,f=c.defaultView||c.parentWindow;if(!avalon.contains(e,a))return b;a.getBoundingClientRect&&(b=a.getBoundingClientRect());var g=e.clientTop||d.clientTop,h=e.clientLeft||d.clientLeft,i=Math.max(f.pageYOffset||0,e.scrollTop,d.scrollTop),j=Math.max(f.pageXOffset||0,e.scrollLeft,d.scrollLeft);return{top:b.top+i-g,left:b.left+j-h}};var vc=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,wc={"option:get":Sa?function(a){return vc.test(a.outerHTML)?a.value:a.text.trim()}:function(a){return a.value},"select:get":function(a,b){for(var c,d=a.options,e=a.selectedIndex,f=wc["option:get"],g="select-one"===a.type||e<0,h=g?null:[],i=g?e+1:d.length,j=e<0?i:g?e:0;j<i;j++)if(c=d[j],(c.selected||j===e)&&!c.disabled){if(b=f(c),g)return b;h.push(b)}return h},"select:set":function(a,b,c){b=[].concat(b);for(var d,e=wc["option:get"],f=0;d=a.options[f++];)(d.selected=b.indexOf(e(d))>-1)&&(c=!0);c||(a.selectedIndex=-1)}},xc={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},yc=a.JSON&&JSON.stringify||function(a){return'"'+a.replace(/[\\\"\x00-\x1f]/g,function(a){var b=xc[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},zc="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",Ac=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,Bc=/[^\w$]+/g,Cc=new RegExp(["\\b"+zc.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),Dc=/\b\d[^,]*/g,Ec=/^,+|,+$/g,Fc=f(512),Gc=function(a){var b=","+a.trim();if(Fc[b])return Fc[b];var c=a.replace(Ac,"").replace(Bc,",").replace(Cc,"").replace(Dc,"").replace(Ec,"").split(/^$|,+/);return Fc(b,ca(c))},Hc=f(128),Ic=/\w\[.*\]|\w\.\w/,Jc=/(\$proxy\$[a-z]+)\d+$/,Kc=/\)\s*$/,Lc=/\)\s*\|/g,Mc=/\|\s*([$\w]+)/g,Nc=/"\s*\["/g,Oc=/"\s*\(/g;avalon.parseExprProxy=fa;var Pc="autofocus,autoplay,async,allowTransparency,checked,controls,declare,disabled,defer,defaultChecked,defaultSelectedcontentEditable,isMap,loop,multiple,noHref,noResize,noShade,open,readOnly,selected",Qc={};Pc.replace(Ca,function(a){Qc[a.toLowerCase()]=a});var Rc={"accept-charset":"acceptCharset",char:"ch",charoff:"chOff",class:"className",for:"htmlFor","http-equiv":"httpEquiv"},Sc="accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan,dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign";Sc.replace(Ca,function(a){Rc[a.toLowerCase()]=a});var Tc=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,Uc=/<noscript.*?>([\s\S]+?)<\/noscript>/im,Vc=function(){return new(a.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},Wc=avalon.templateCache={};Wa.attr=function(a,b){var c=a.value.trim(),d=!0;if(c.indexOf(hb)>-1&&c.indexOf(ib)>2&&(d=!1,jb.test(c)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(d=!0,c=RegExp.$1)),"include"===a.type){var e=a.element;a.includeRendered=Ob(e,"data-include-rendered",b),a.includeLoaded=Ob(e,"data-include-loaded",b);var f=a.includeReplaced=!!avalon(e).data("includeReplace");a.startInclude=ua.createComment("ms-include"),a.endInclude=ua.createComment("ms-include-end"),f?(a.element=a.startInclude,e.parentNode.insertBefore(a.startInclude,e),e.parentNode.insertBefore(a.endInclude,e.nextSibling)):(e.insertBefore(a.startInclude,e.firstChild),e.appendChild(a.endInclude))}a.handlerName="attr",fa(c,b,a,d?0:U(a.value))},Xa.attr=function(b,c,d){var e=d.type,f=d.param;if("css"===e)avalon(c).css(f,b);else if("attr"===e){if(Qc[f]){var g=Qc[f];if("boolean"==typeof c[g])return c[g]=!!b}var h=b===!1||null===b||void 0===b;if(!Ma&&Rc[f]&&(f=Rc[f]),h)return c.removeAttribute(f);var i=!Ea.test(c)&&(!(!ua.namespaces||!I(c))||f in c.cloneNode(!1));i?c[f]=b:c.setAttribute(f,b)}else if("include"===e&&b){var j=d.vmodels,k=d.includeRendered,l=d.includeLoaded,m=d.includeReplaced,n=m?c.parentNode:c,o=function(a){for(l&&(a=l.apply(n,[a].concat(j))),k&&K(n,function(){k.call(n)},NaN);;){var b=d.startInclude.nextSibling;if(!b||b===d.endInclude)break;n.removeChild(b)}var c=avalon.parseHTML(a),e=avalon.slice(c.childNodes);n.insertBefore(c,d.endInclude),Q(e,j)};if("src"===d.param)if(Wc[b])avalon.nextTick(function(){o(Wc[b])});else{var p=Vc();p.onreadystatechange=function(){if(4===p.readyState){var a=p.status;(a>=200&&a<300||304===a||1223===a)&&o(Wc[b]=p.responseText)}},p.open("GET",b,!0),"withCredentials"in p&&(p.withCredentials=!0),p.setRequestHeader("X-Requested-With","XMLHttpRequest"),p.send(null)}else{var q=b&&1===b.nodeType?b:ua.getElementById(b);if(q){if("NOSCRIPT"===q.tagName&&!q.innerHTML&&!q.fixIE78){p=Vc(),p.open("GET",location,!1),p.send(null);for(var r=ua.getElementsByTagName("noscript"),s=(p.responseText||"").match(Tc)||[],t=s.length,u=0;u<t;u++){var v=r[u];v&&(v.style.display="none",v.fixIE78=(s[u].match(Uc)||["","&nbsp;"])[1])}}avalon.nextTick(function(){o(q.fixIE78||q.value||q.innerText||q.innerHTML)})}}}else if(Na.hasAttribute||"string"!=typeof b||"src"!==e&&"href"!==e||(b=b.replace(/&amp;/g,"&")),c[e]=b,a.chrome&&"EMBED"===c.tagName){var w=c.parentNode,x=document.createComment("ms-src");w.replaceChild(x,c),w.replaceChild(c,x)}},"title,alt,src,value,css,include,href".replace(Ca,function(a){Wa[a]=Wa.attr}),Wa.class=function(a,b){var d,e=a.param,f=a.value;if(a.handlerName="class",!e||isFinite(e)){a.param="";var g=f.replace(kb,function(a){return a.replace(/./g,"0")}),h=g.indexOf(":");if(h===-1)var i=f;else{if(i=f.slice(0,h),d=f.slice(h+1),ea(d,b,a),!a.evaluator)return c("debug: ms-class '"+(d||"").trim()+"' 不存在于VM中"),!1;a._evaluator=a.evaluator,a._args=a.args}var j=jb.test(i);j||(a.immobileClass=i),fa("",b,a,j?U(i):0)}else a.immobileClass=a.oldStyle=a.param,fa(f,b,a)},Xa.class=function(a,b,c){var d=avalon(b),e=c.type;if("class"===e&&c.oldStyle)d.toggleClass(c.oldStyle,!!a);else switch(c.toggleClass=!c._evaluator||!!c._evaluator.apply(b,c._args),c.newClass=c.immobileClass||a,c.oldClass&&c.newClass!==c.oldClass&&d.removeClass(c.oldClass),c.oldClass=c.newClass,e){case"class":d.toggleClass(c.newClass,c.toggleClass);break;case"hover":case"active":if(!c.hasBindEvent){var f="mouseenter",g="mouseleave";if("active"===e){b.tabIndex=b.tabIndex||-1,f="mousedown",g="mouseup";var h=d.bind("mouseleave",function(){c.toggleClass&&d.removeClass(c.newClass)})}var i=d.bind(f,function(){c.toggleClass&&d.addClass(c.newClass)}),j=d.bind(g,function(){c.toggleClass&&d.removeClass(c.newClass)});c.rollback=function(){d.unbind("mouseleave",h),d.unbind(f,i),d.unbind(g,j)},c.hasBindEvent=!0}}},"hover,active".replace(Ca,function(a){Wa[a]=Wa.class}),Xa.data=function(a,b,c){var d="data-"+c.param;a&&"object"==typeof a?b[d]=a:b.setAttribute(d,String(a))};var Xc=Wa.duplex=function(a,b){var f,g=a.element;if(fa(a.value,b,a,0,1),a.changed=Ob(g,"data-duplex-changed",b)||d,a.evaluator&&a.args){var h=[],i=e("string,number,boolean,checked");"radio"===g.type&&""===a.param&&(a.param="checked"),g.msData&&(g.msData["ms-duplex"]=a.value),a.param.replace(/\w+/g,function(b){/^(checkbox|radio)$/.test(g.type)&&/^(radio|checked)$/.test(b)&&("radio"===b&&c("ms-duplex-radio已经更名为ms-duplex-checked"),b="checked",a.isChecked=!0),"bool"===b?(b="boolean",c("ms-duplex-bool已经更名为ms-duplex-boolean")):"text"===b&&(b="string",c("ms-duplex-text已经更名为ms-duplex-string")),i[b]&&(f=!0),avalon.Array.ensure(h,b)}),f||h.push("string"),a.param=h.join("-"),a.bound=function(b,c){g.addEventListener?g.addEventListener(b,c,!1):g.attachEvent("on"+b,c);var d=a.rollback;a.rollback=function(){g.avalonSetter=null,avalon.unbind(g,b,c),d&&d()}};for(var j in avalon.vmodels){var k=avalon.vmodels[j];k.$fire("avalon-ms-duplex-init",a)}var l=a.pipe||(a.pipe=ha);l(null,a,"init");var m=g.tagName;Xc[m]&&Xc[m](g,a.evaluator.apply(null,a.args),a)}};avalon.duplexHooks={checked:{get:function(a,b){return!b.element.oldValue}},string:{get:function(a){return a},set:ga},boolean:{get:function(a){return"true"===a},set:ga},number:{get:function(a){return isFinite(a)?parseFloat(a)||0:a},set:ga}};var Yc,Zc=[];avalon.tick=function(a){1===Zc.push(a)&&(Yc=setInterval(ia,60))};var $c=d;new function(){function a(a){avalon.contains(Na,this)&&(b[this.tagName].call(this,a),this.avalonSetter&&this.avalonSetter())}try{var b={},c=HTMLInputElement.prototype,d=HTMLTextAreaElement.prototype,e=HTMLInputElement.prototype;Object.getOwnPropertyNames(e),b.INPUT=Object.getOwnPropertyDescriptor(c,"value").set,Object.defineProperty(c,"value",{set:a}),b.TEXTAREA=Object.getOwnPropertyDescriptor(d,"value").set,Object.defineProperty(d,"value",{set:a})}catch(a){$c=avalon.tick}},Sa&&avalon.bind(ua,"selectionchange",function(a){var b=ua.activeElement;b&&"function"==typeof b.avalonSetter&&b.avalonSetter()}),Xc.INPUT=function(a,b,d){function e(a){d.changed.call(this,a,d)}function f(){m=!0}function g(){m=!1,setTimeout(h)}function h(){if(!m){var c=a.oldValue=a.value,f=d.pipe(c,d,"get");l.data("duplex-observe")!==!1&&(b(f),e.call(a,f),l.data("duplex-focus")&&avalon.nextTick(function(){a.focus()}))}}function i(a){setTimeout(function(){h(a)})}var j=a.type,k=d.bound,l=avalon(a),m=!1;if(d.handler=function(){var c=d.pipe(b(),d,"set")+"";c!==a.oldValue&&(a.value=c)},d.isChecked||"radio"===a.type){var n=6===Sa;h=function(){if(l.data("duplex-observe")!==!1){var c=d.pipe(a.value,d,"get");b(c),e.call(a,c)}},d.handler=function(){var c=b(),e=d.isChecked?!!c:c+""===a.value;a.oldValue=e,n?setTimeout(function(){a.defaultChecked=e,a.checked=e},31):a.checked=e},k("click",h)}else if("checkbox"===j)h=function(){if(l.data("duplex-observe")!==!1){var f=a.checked?"ensure":"remove",g=b();Array.isArray(g)||(c("ms-duplex应用于checkbox上要对应一个数组"),g=[g]),avalon.Array[f](g,d.pipe(a.value,d,"get")),e.call(a,g)}},d.handler=function(){var c=[].concat(b());a.checked=c.indexOf(d.pipe(a.value,d,"get"))>-1},k(Ma?"change":"click",h);else{var o=a.getAttribute("data-duplex-event")||a.getAttribute("data-event")||"input";a.attributes["data-event"]&&c("data-event指令已经废弃，请改用data-duplex-event"),o.replace(Ca,function(a){switch(a){case"input":Sa?(Sa>8?k("input",h):k("propertychange",function(a){"value"===a.propertyName&&h()}),k("dragend",i)):(k("input",h),k("compositionstart",f),k("compositionend",g),k("DOMAutoComplete",h));break;default:k(a,h)}})}/text|password/.test(a.type)&&$c(function(){if(Na.contains(a))a.value!==a.oldValue&&h();else if(!a.msRetain)return!1}),a.avalonSetter=h,a.oldValue=a.value,B(d),e.call(a,a.value)},Xc.TEXTAREA=Xc.INPUT,Xc.SELECT=function(a,b,d){function e(){if(f.data("duplex-observe")!==!1){var c=f.val();c=Array.isArray(c)?c.map(function(a){return d.pipe(a,d,"get")}):d.pipe(c,d,"get"),c+""!==a.oldValue&&b(c),d.changed.call(a,c,d)}}var f=avalon(a);d.handler=function(){var d=b();d=d&&d.$model||d,Array.isArray(d)?a.multiple||c("ms-duplex在<select multiple=true>上要求对应一个数组"):a.multiple&&c("ms-duplex在<select multiple=false>不能对应一个数组"),d=Array.isArray(d)?d.map(String):d+"",d+""!==a.oldValue&&(f.val(d),a.oldValue=d+"")},d.bound("change",e),K(a,function(){B(d),d.changed.call(a,b(),d)},NaN)},Xa.html=function(a,b,c){a=null==a?"":a;var d="group"in c,e=d?b.parentNode:b;if(e){if(11===a.nodeType)var f=a;else if(1===a.nodeType||a.item){var g=1===a.nodeType?a.childNodes:a.item?a:[];for(f=Oa.cloneNode(!0);g[0];)f.appendChild(g[0])}else f=avalon.parseHTML(a);var h=ua.createComment("ms-html");if(d){e.insertBefore(h,b);for(var i=c.group,j=1;j<i;){var k=b.nextSibling;k&&(e.removeChild(k),j++)}e.removeChild(b),c.element=h}else avalon.clearHTML(e).appendChild(h);d&&(c.group=f.childNodes.length||1),g=avalon.slice(f.childNodes),g[0]&&(h.parentNode&&h.parentNode.replaceChild(f,h),d&&(c.element=g[0])),Q(g,c.vmodels)}},Wa.if=Wa.data=Wa.text=Wa.html=function(a,b){fa(a.value,b,a)},Xa.if=function(a,b,c){if(a)8===b.nodeType&&(b.parentNode.replaceChild(c.template,b),b=c.element=c.template),b.getAttribute(c.name)&&(b.removeAttribute(c.name),O(b,c.vmodels)),c.rollback=null;else if(1===b.nodeType){var d=c.element=ua.createComment("ms-if");b.parentNode.replaceChild(d,b),c.template=b,wa.appendChild(b),c.rollback=function(){b.parentNode===wa&&wa.removeChild(b)}}};var _c=/\(([^)]*)\)/;Wa.on=function(a,b){var c=a.value;a.type="on";var d=a.param.replace(/-\d+$/,"");if("function"==typeof Wa.on[d+"Hook"]&&Wa.on[d+"Hook"](a),c.indexOf("(")>0&&c.indexOf(")")>-1){var e=(c.match(_c)||["",""])[1].trim();""!==e&&"$event"!==e||(c=c.replace(_c,""))}fa(c,b,a)},Xa.on=function(a,b,c){a=function(a){var b=c.evaluator||d;return b.apply(this,c.args.concat(a))};var e=c.param.replace(/-\d+$/,"");if("scan"===e)a.call(b,{type:e});else if("function"==typeof c.specialBind)c.specialBind(b,a);else var f=avalon.bind(b,e,a);c.rollback=function(){"function"==typeof c.specialUnbind?c.specialUnbind():avalon.unbind(b,e,f)}},Wa.repeat=function(a,b){var c=a.type;fa(a.value,b,a,0,1),a.proxies=[];var d=!1;try{var e=a.$repeat=a.evaluator.apply(0,a.args||[]),f=avalon.type(e);"object"!==f&&"array"!==f&&(d=!0,avalon.log("warning:"+a.value+"对应类型不正确"))}catch(b){d=!0,avalon.log("warning:"+a.value+"编译出错")}var g=a.value.split(".")||[];if(g.length>1){g.pop();for(var h,i=g[0],j=0;h=b[j++];)if(h&&h.hasOwnProperty(i)){var k=h[i].$events||{};k[ya]=k[ya]||[],k[ya].push(a);break}}var l=a.element;l.removeAttribute(a.name),a.sortedCallback=Ob(l,"data-with-sorted",b),a.renderedCallback=Ob(l,"data-"+c+"-rendered",b);var m=Ra(c),n=a.element=ua.createComment(m+":end");if(a.clone=ua.createComment(m),Oa.appendChild(n),"each"===c||"with"===c?(a.template=l.innerHTML.trim(),avalon.clearHTML(l).appendChild(n)):(a.template=l.outerHTML.trim(),l.parentNode.replaceChild(n,l)),a.template=avalon.parseHTML(a.template),a.rollback=function(){var b=a.element;if(b){Xa.repeat.call(a,"clear");var c=b.parentNode,d=a.template,e=d.firstChild;c.replaceChild(d,b);var f=a.$stamp;f&&f.parentNode&&f.parentNode.removeChild(f),e=a.element="repeat"===a.type?e:c}},!d){a.handler=Xa.repeat,a.$outer={};var o="$key",p="$val";for(Array.isArray(e)&&(o="$first",p="$last"),j=0;h=b[j++];)if(h.hasOwnProperty(o)&&h.hasOwnProperty(p)){a.$outer=h;break}var q=e.$events,r=(q||{})[ya];if(r&&avalon.Array.ensure(r,a)&&D(a,r),"object"===f){a.$with=!0;var s=q?q.$withProxyPool||(q.$withProxyPool={}):{};a.handler("append",e,s)}else e.length&&a.handler("add",0,e.length)}},Xa.repeat=function(a,b,c){if(a){var e=this,f=e.element,g=f.parentNode,h=e.proxies,i=Oa.cloneNode(!1);switch(a){case"add":for(var j,k=b+c,l=e.$repeat,m=l.length-1,n=[],o=ka(e,b),p=b;p<k;p++){var q=na(p,e);h.splice(p,0,q),ja(e,i,q,n)}for(g.insertBefore(i,o),p=0;j=n[p++];)Q(j.nodes,j.vmodels),j.nodes=j.vmodels=null;break;case"del":o=h[b].$stamp,f=ka(e,b+c),la(o,f);var r=h.splice(b,c);qa(r,"each");break;case"clear":var s=e.$stamp||h[0];s&&(o=s.$stamp||s,la(o,f)),qa(h,"each");break;case"move":o=h[0].$stamp;var t,u=o.nodeValue,v=[],w=[];for(la(o,f,function(){w.unshift(this),this.nodeValue===u&&(v.unshift(w),w=[])}),A(h,b),A(v,b);w=v.shift();)for(;t=w.shift();)i.appendChild(t);g.insertBefore(i,f);break;case"index":for(m=h.length-1;c=h[b];b++)c.$index=b,c.$first=0===b,c.$last=b===m;return;case"set":return q=h[b],void(q&&H(q.$events.$index));case"append":var x=c,y=[];n=[];for(var z in b)b.hasOwnProperty(z)&&"hasOwnProperty"!==z&&y.push(z);if(e.sortedCallback){var B=e.sortedCallback.call(g,y);B&&Array.isArray(B)&&B.length&&(y=B)}for(p=0;z=y[p++];)"hasOwnProperty"!==z&&(x[z]||(x[z]=pa(z,e)),ja(e,i,x[z],n));var C=e.$stamp=e.clone;for(g.insertBefore(C,f),g.insertBefore(i,f),p=0;j=n[p++];)Q(j.nodes,j.vmodels),j.nodes=j.vmodels=null}"clear"===a&&(a="del");var D=e.renderedCallback||d,E=arguments;K(g,function(){D.apply(g,E),g.oldValue&&"SELECT"===g.tagName&&avalon(g).val(g.oldValue.split(","))},NaN)}},"with,each".replace(Ca,function(a){Wa[a]=Wa.repeat});var ad=[],bd=[];Xa.text=function(a,b){if(a=null==a?"":a,3===b.nodeType)try{b.data=a}catch(a){}else"textContent"in b?b.textContent=a:b.innerText=a},avalon.parseDisplay=ra,Wa.visible=function(a,b){var c=avalon(a.element),d=c.css("display");if("none"===d){var e=c[0].style,f=/visibility/i.test(e.cssText),g=c.css("visibility");e.display="",e.visibility="hidden",d=c.css("display"),"none"===d&&(d=ra(c[0].nodeName)),e.visibility=f?g:""}a.display=d,fa(a.value,b,a)},Xa.visible=function(a,b,c){b.style.display=a?c.display:"none"},Wa.widget=function(b,c){var e=b.value.match(Ca),f=b.element,g=e[0],h=e[1];h&&"$"!==h||(h=Ra(g));var i=e[2]||g,j=avalon.ui[g];if("function"==typeof j){c=f.vmodels||c;for(var k,l=0;k=c[l++];)if(k.hasOwnProperty(i)&&"object"==typeof k[i]){var m=k[i];m=m.$model||m;break}if(m){var n=m[g+"Id"];"string"==typeof n&&(h=n)}var o=avalon.getWidgetData(f,g);b.value=[g,h,i].join(","),b[g+"Id"]=h,b.evaluator=d,f.msData["ms-widget-id"]=h;var p=b[g+"Options"]=avalon.mix({},j.defaults,m||{},o);f.removeAttribute("ms-widget");var q=j(f,b,c)||{};q.$id?(avalon.vmodels[h]=q,L(f,q),q.hasOwnProperty("$init")&&q.$init(function(){avalon.scan(f,[q].concat(c)),"function"==typeof p.onInit&&p.onInit.call(f,q,p,c)}),b.rollback=function(){try{q.widgetElement=null,q.$remove()}catch(a){}f.msData={},delete avalon.vmodels[q.$id]},D(b,cd),a.chrome&&f.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(G)})):avalon.scan(f,c)}else c.length&&(f.vmodels=c)};var cd=[],dd=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,ed=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,fd=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,gd={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},hd=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,id=/([^\#-~| |!])/g,jd=avalon.filters={uppercase:function(a){return a.toUpperCase()},lowercase:function(a){return a.toLowerCase()},truncate:function(a,b,c){return b=b||30,c=void 0===c?"...":c,a.length>b?a.slice(0,b-c.length)+c:String(a)},$filter:function(a){for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b],e=avalon.filters[d.shift()];if("function"==typeof e){var f=[a].concat(d);a=e.apply(null,f)}}return a},camelize:X,sanitize:function(a){return a.replace(dd,"").replace(fd,function(a,b){var c=a.toLowerCase().match(/<(\w+)\s/);if(c){var d=gd[c[1]];d&&(a=a.replace(d,function(a,b,c){var d=c.charAt(0);return b+"="+d+"javascript:void(0)"+d}))}return a.replace(ed," ").replace(/\s+/g," ")})},escape:function(a){return String(a).replace(/&/g,"&amp;").replace(hd,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(id,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(a,b,c){return(b||"￥")+sa(a,isFinite(c)?c:2)},number:sa};return new function(){function a(a){return parseInt(a,10)||0}function b(a,b,c){var d="";for(a<0&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function c(a,c,d,e){return function(f){var g=f["get"+a]();return(d>0||g>-d)&&(g+=d),0===g&&d===-12&&(g=12),b(g,c,e)}}function d(a,b){return function(c,d){var e=c["get"+a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}function e(a){var c=-1*a.getTimezoneOffset(),d=c>=0?"+":"";return d+=b(Math[c>0?"floor":"ceil"](c/60),2)+b(Math.abs(c%60),2)}function f(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}var g={yyyy:c("FullYear",4),yy:c("FullYear",2,0,!0),y:c("FullYear",1),MMMM:d("Month"),MMM:d("Month",!0),MM:c("Month",2,1),M:c("Month",1,1),dd:c("Date",2),d:c("Date",1),HH:c("Hours",2),H:c("Hours",1),hh:c("Hours",2,-12),h:c("Hours",1,-12),mm:c("Minutes",2),m:c("Minutes",1),ss:c("Seconds",2),s:c("Seconds",1),sss:c("Milliseconds",3),EEEE:d("Day"),EEE:d("Day",!0),a:f,Z:e},h=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,i=/^\/Date\((\d+)\)\/$/;jd.date=function(b,c){var d,e,f=jd.date.locate,j="",k=[];if(c=c||"mediumDate",c=f[c]||c,"string"==typeof b)if(/^\d+$/.test(b))b=a(b);else if(i.test(b))b=+RegExp.$1;else{var l=b.trim(),m=[0,0,0,0,0,0,0],n=new Date(0);l=l.replace(/^(\d+)\D(\d+)\D(\d+)/,function(b,c,d,e){var f=4===e.length?[e,c,d]:[c,d,e];return m[0]=a(f[0]),m[1]=a(f[1])-1,m[2]=a(f[2]),""});var o=n.setFullYear,p=n.setHours;l=l.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(b,c,d,e,f){return m[3]=a(c),m[4]=a(d),m[5]=a(e),f&&(m[6]=Math.round(1e3*parseFloat("0."+f))),""});var q=0,r=0;l=l.replace(/Z|([+-])(\d\d):?(\d\d)/,function(b,c,d,e){return o=n.setUTCFullYear,p=n.setUTCHours,c&&(q=a(c+d),r=a(c+e)),""}),m[3]-=q,m[4]-=r,o.apply(n,m.slice(0,3)),p.apply(n,m.slice(3)),b=n}if("number"==typeof b&&(b=new Date(b)),"date"===avalon.type(b)){for(;c;)e=h.exec(c),e?(k=k.concat(e.slice(1)),c=k.pop()):(k.push(c),c=null);return k.forEach(function(a){d=g[a],j+=d?d(b,f):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),j}};var j={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss",short:"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};j.SHORTMONTH=j.MONTH,jd.date.locate=j},new function(){function a(a){for(c=1;a=d.shift();)a()}avalon.config({loader:!1});var b,c,d=[];if(Ma)avalon.bind(ua,"DOMContentLoaded",b=function(){avalon.unbind(ua,"DOMContentLoaded",b),a()});else var e=setInterval(function(){"complete"===document.readyState&&document.body&&(clearInterval(e),a())},50);avalon.ready=function(a){c?a(avalon):d.push(a)},avalon.ready(function(){avalon.scan(ua.body)})},"function"==typeof define&&define.amd&&define("avalon",[],function(){return avalon}),a.avalon,avalon.noConflict=function(b){return b&&a.avalon===avalon&&(a.avalon=avalon),avalon},void 0===b&&(a.avalon=avalon),avalon});