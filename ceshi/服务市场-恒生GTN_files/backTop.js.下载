function openYsf(){ysf.open()}function backTop(){document.documentElement.scrollTop=document.body.scrollTop=0}function showBackTop(){window.onscroll=function(){(document.documentElement.scrollTop||document.body.scrollTop)>document.documentElement.clientHeight?$("#to_top").show():$("#to_top").hide()}}function openPop(){$("body").css("overflow","hidden"),$("#sjSubmitPhone,#sjSubmitCode,#sjSubmitDes,#sjSubmitName,#sjSubmitTel,#sjSubmitContact").val(""),$("#sjSubmitModal,.black_overlay").fadeIn(),1==logOut?$("#sjPhoneItem,#sjCodeItem").show():$("#sjPhoneItem,#sjCodeItem").hide()}function closePop(){$("body").css("overflow","auto"),$("#sjSubmitModal .modal-text-placeholder").show(),$("#sjSubmitModal input,#sjSubmitModal textarea").css("border","1px solid #bbbbbb"),$("#sjSubmitModal,.black_overlay").fadeOut(300),$("#sjSubmitModal .modal-input-error").hide(),$("#sjSubmitPhone,#sjSubmitCode,#sjSubmitDes,#sjSubmitName,#sjSubmitTel,#sjSubmitContact").val("")}function closeConfirmPop(){$("body").css("overflow","auto"),closePop(),$("#sjSubmitSuccess,.black_overlay").fadeOut(300)}function confirmSubmit(){$("body").css("overflow","auto"),logOut?$("#sjSubmitSuccess,.black_overlay").hide():($("#sjSubmitSuccess,.black_overlay").hide(),window.location.href="/cloud/open/feedback/workOrderList.html")}function validate(){var e=$("#content"),t=$(".error_tip .red_tan"),r=e.val();return r&&0!=r.trim().length?r.length>300?(t.html("反馈上限为300字，请检查后提交"),t.css("visibility","visible"),$(".error_tip").show(),!1):(t.html("&nbsp;"),t.css("visibility","hidden"),$(".error_tip").hide(),!0):(t.html("请输入反馈内容"),t.css("visibility","visible"),$(".error_tip").show(),!1)}function validate_contact_info(){var e=$.trim($("#contact_info").val());$("#contact_info_box");if(""==e){return $(".sl-error").css("display","inline-block"),$("#error_info").html("联系方式不能为空"),!1}return/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/.test(e)||/^1[3|4|5|7|8]\d{9}$/.test(e)||/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/.test(e)||""==e?($(".sl-error").hide(),!0):($(".sl-error").css("display","inline-block"),$("#error_info").html("联系方式为手机号或邮箱，请检查您的格式是否正确！"),!1)}function tips(e,t){t=null==t?1e3:t,$.blockUI({message:'<div class="con-pop"><div class="inner"><div class="details"><p style="text-align: center">'+e+"</p></div></div></div>",timeout:t,overlayCSS:{opacity:.15,cursor:"default"},css:{left:"43%",position:"fixed",border:"0px",backgroundColor:"none",cursor:"auto",textAlign:"left"}})}function checkDescribe(e){return e.currentTarget?(val=$.trim($(e.currentTarget).val()),dom=$(e.currentTarget),errordom=$(e.currentTarget.parentElement.children[1]),textdom=$(e.currentTarget.parentElement.children[1].children[1])):(val=$.trim($(e).val()),dom=$(e),errordom=$($(e).parent().children()[2])),val=val.replace(/\s+/g,""),""==val?(dom.css("border","1px solid #e24a4a"),errordom.text("具体描述不能为空").css("display","block"),!1):val.length>500?(dom.css("border","1px solid #e24a4a"),errordom.text("输入超出最大限制数").css("display","block"),!1):(dom.css("border","1px solid #bbbbbb"),errordom.css("display","none"),!0)}function checkTel(e){return e.currentTarget?(val=$.trim($(e.currentTarget).val()),dom=$(e.currentTarget),errordom=$(e.currentTarget.parentElement.children[1]),textdom=$(e.currentTarget.parentElement.children[1].children[1])):(val=$.trim($(e).val()),dom=$(e),errordom=$($(e).parent().children()[2])),""==val?(dom.css("border","1px solid #e24a4a"),errordom.text("客户联系电话不能为空").css("display","block"),!1):/^[\d|\-]{8,13}$/.test(val)?(dom.css("border","1px solid #bbbbbb"),errordom.css("display","none"),!0):(dom.css("border","1px solid #e24a4a"),errordom.text("输入格式不正确").css("display","block"),!1)}function checkMobile(e){return e.currentTarget?(val=$.trim($(e.currentTarget).val()),dom=$(e.currentTarget),errordom=$(e.currentTarget.parentElement.children[1]),textdom=$(e.currentTarget.parentElement.children[1].children[1])):(val=$.trim($(e).val()),dom=$(e),errordom=$($(e).parent().children()[2])),""==val?(dom.css("border","1px solid #e24a4a"),errordom.text("商机提交人手机不能为空").css("display","block"),!1):/^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/.test(val)?(dom.css("border","1px solid #bbbbbb"),errordom.css("display","none"),!0):(dom.css("border","1px solid #e24a4a"),errordom.text("输入格式不正确").css("display","block"),!1)}function checkCode(e){return e.currentTarget?(val=$.trim($(e.currentTarget).val()),dom=$(e.currentTarget),errordom=$(e.currentTarget.parentElement.children[1]),textdom=$(e.currentTarget.parentElement.children[1].children[1])):(val=$.trim($(e).val()),dom=$(e),errordom=$($(e).parent().children()[3])),""==val?(dom.css("border","1px solid #e24a4a"),errordom.text(" 验证码不能为空").css("display","block"),!1):/^\d{6}$/.test(val)?(dom.css("border","1px solid #bbbbbb"),errordom.css("display","none"),!0):(dom.css("border","1px solid #e24a4a"),errordom.text("输入格式不正确").css("display","block"),!1)}function checkName(e){return e.currentTarget?(val=$.trim($(e.currentTarget).val()),dom=$(e.currentTarget),errordom=$(e.currentTarget.parentElement.children[1]),textdom=$(e.currentTarget.parentElement.children[1].children[1])):(val=$.trim($(e).val()),dom=$(e),errordom=$($(e).parent().children()[2])),""==val?(dom.css("border","1px solid #e24a4a"),errordom.text("客户名称不能为空").css("display","block"),!1):/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_]){1,50}$/.test(val)?(dom.css("border","1px solid #bbbbbb"),errordom.css("display","none"),!0):(dom.css("border","1px solid #e24a4a"),errordom.text("输入格式不正确").css("display","block"),!1)}function getfocus(e){$("#sjSubmitModal .modal-text-placeholder").hide(),1==e&&$("#sjSubmitModal textarea").focus()}showBackTop();var logOut="";function islogin(){$.ajax({url:"/cloud/open/user/islogin.json",dataType:"json",type:"post",success:function(e){e.success?logOut=0==e.data:(tips(e.error_info),logOut=!0)},error:function(e,t,r){4!=e.readyState||"200"!=e.status&&"OK"!=t?tips("调用数据失败，请稍后再试。"):tips(t),logOut=!0}})}function submit(){var e=$("#sjSubmitName").val(),t=$.trim($("#sjSubmitTel").val()),r=$.trim($("#sjSubmitContact").val()),o=$.trim($("#sjSubmitDes").val()),s=$.trim($("#sjSubmitPhone").val()),n=$.trim($("#sjSubmitCode").val()),i={content:o.replace(/\s+/g,""),customer_name:e,contact_name:r,contact_phone:t,phone:s,checkcode:n,feedback_type:3};if(1==logOut){if(!(checkName($("#sjSubmitName"))&&checkDescribe($("#sjSubmitDes"))&&checkCode($("#sjSubmitCode"))&&checkMobile($("#sjSubmitPhone"))))return!1}else if(!checkName($("#sjSubmitName"))||!checkDescribe($("#sjSubmitDes")))return!1;$.ajax({url:"/cloud/open/feedback/addFeedbackInfo.json",dataType:"json",type:"post",data:i,success:function(e){1==e.success?($("#sjSubmitSuccess,.black_overlay").fadeIn(),null==e.data?($("#sjSubmitModal").hide(),$("#sjSubmitSuccess .confirm-content").text("商机已提交成功")):tips("商机提交失败")):tips(e.error_info)},error:function(e,t,r){4!=e.readyState||"200"!=e.status&&"OK"!=t?tips("调用数据失败，请稍后再试。"):tips(t)}})}function change(){var e=(new Date).getTime();$("#changeImg").attr("src","/cloud/open/imageCode/getImageCode.json?time="+e)}var sjSubmitInter="",sjSubmitFlag=!0;function count(){var e=60,t=$("#sjSubmitModal .code-get-btn");sjSubmitInter=setInterval(function(){0==e?(clearInterval(sjSubmitInter),sjSubmitFlag=!0,e=60,t.css("cursor","pointer"),t.css("color","#00aaee"),t.html("获取验证码")):(sjSubmitFlag=!1,e--,t.css("color","#bbbbbb"),t.css("cursor","default"),t.html(e+"s后获取"))},1e3)}function getCheckCode(){if(checkMobile($("#sjSubmitPhone")),!checkMobile($("#sjSubmitPhone")))return!1;if(sjSubmitFlag){sjSubmitFlag=!1,count();var e={phone:$.trim($("#sjSubmitPhone").val())};$.ajax({url:"/cloud/open/getCheckCode.json",type:"post",dataType:"json",data:e,success:function(e){e.error_info&&tips(e.error_info)},error:function(e,t,r){4!=e.readyState||"200"!=e.status&&"OK"!=t?tips("调用数据失败，请稍后再试。"):tips(t)}})}}$(function(){islogin(),$(".kefu_box").hover(function(){$(".tab_tips a").mouseover(function(){}),$(".tab_tips").css("display","block").stop().animate({left:"-288px",width:"314px"})},function(){$(".tab_tips").css("display","none").stop().animate({left:"0px",width:"0"})}),$(".tab_tips a").hover(function(){$($(this).children()[1]).find(".title").css("color","#00aaee")},function(){$($(this).children()[1]).find(".title").css("color","#333")}),setTimeout(function(){$("input,textarea").focus(function(e){$(e.currentTarget).css("border","1px solid #bbbbbb"),$($(e.currentTarget).parent().find(".modal-input-error")).hide(),$(".form-line-wrapper .input").css("border","none")}),logOut?$("#sjSubmitModal").css("margin-top","-300px"):$("#sjSubmitModal").css("margin-top","-245px")},500)});