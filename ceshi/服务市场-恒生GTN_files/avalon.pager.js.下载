define(["avalon","text!js/vendor/pager/avalon.pager.html","css!js/vendor/pager/avalon.pager.css"],function(B,D){var E=B.ui.pager=function(J,K,I){var H=K.pagerOptions;var G=H.options;if(Array.isArray(G)){H.options=G.map(function(L){var M={};switch(typeof L){case"number":case"string":M.value=L;M.text=L;return M;case"object":return L}})}else{H.options=[]}if(I.cb){D=D.replace(/ms-title/g,"ms-attr-title")}H.template=H.getTemplate(D,H);H._currentPage=H.currentPage;var F=B.define(K.pagerId,function(L){B.mix(L,H,{regional:E.defaultRegional});L.widgetElement=J;L.rootElement={};L.$skipArray=["showPages","rootElement","widgetElement","template","ellipseText","alwaysShowPrev","alwaysShowNext"];L.$init=function(N){var M=H.template;J.style.display="none";setTimeout(function(){J.innerHTML=M;L.rootElement=J.getElementsByTagName("*")[0];J.style.display="block";if(N){N()}else{B.log("avalon请尽快升到1.3.7+");B.scan(J,[F].concat(I));if(typeof H.onInit==="function"){H.onInit.call(J,F,H,I)}}},100)};L.$remove=function(){J.innerHTML=J.textContent=""};L.jumpPage=function(M,O){M.preventDefault();var N=this.className.indexOf("state-disabled")===-1;if(N&&O!==L.currentPage){switch(O){case"first":L.currentPage=1;break;case"last":L.currentPage=L.totalPages;break;case"next":L.currentPage++;if(L.currentPage>L.totalPages){L.currentPage=L.totalPages}break;case"prev":L.currentPage--;if(L.currentPage<1){L.currentPage=1}break;default:L.currentPage=O;break}L.onJump.call(J,M,L);C(L.pages,A(L))}};L.$watch("totalItems",function(){C(L.pages,A(L))});L.$watch("perPages",function(M){L.currentPage=1;C(L.pages,A(L))});L.$watch("currentPage",function(M){F._currentPage=M;C(L.pages,A(L))});L.isShowPrev=function(){var N=L.alwaysShowPrev;var M=L.firstPage;return N||M!==1};L.isShowNext=function(){var O=L.alwaysShowNext;var M=L.lastPage;var N=L.totalPages;return O||M!==N};L.changeCurrentPage=function(M,N){if(M.type==="keyup"){N=this.value;if(M.keyCode!==13){return}}else{N=F._currentPage}N=parseInt(N,10)||1;if(N>F.totalPages||N<1){return}F.currentPage=N;F.pages=A(F);F.onJump.call(J,M,L)};L.pages=[];L.getPages=A;L.setRegional=function(M){F.regional=M};L._getTotalPages=function(O){var N=F.regional,M=[N.totalText,O];if(O>1){M.push(N.pagesText)}else{M.push(N.pageText)}M=M.concat([" ",N.jumpToText,N.numberText]);return M.join("")};L.getTitle=function(P,N,O){var M=F.regional;switch(P){case"first":if(N==1){return M.currentText}return M.jumpToText+" "+M.firstText;case"prev":return M.jumpToText+" "+M.prevText;case"next":return M.jumpToText+" "+M.nextText;case"last":if(N==O){return M.currentText}return M.jumpToText+" "+M.lastText;default:if(P===N){return M.currentText}return M.jumpToText+M.numberText+" "+P+M.pageText}}});F.pages=A(F);return F};function C(G,I){var L={};for(var J=0,K=G.length;J<K;J++){var M=G[J];L[M]={action:"del",el:M}}for(var J=0,H=I.length;J<H;J++){var M=I[J];if(L[M]){L[M]={action:"retain",el:M}}else{L[M]={action:"add",el:M}}}var N=[];for(var J in L){N.push({action:L[J].action,el:L[J].el})}N.sort(function(P,O){return P.el-O.el});N.forEach(function(O,P){O.index=P});var F=[];for(var J=0,M;M=N[J++];){switch(M.action){case"add":G.splice(M.index,0,M.el);break;case"del":F.unshift(M);break}}for(var J=0,M;M=F[J++];){G.splice(M.index,1)}}E.regional=[];E.regional["zh-CN"]={prevText:"上一页",nextText:"下一页",confirmText:"确定",totalText:"共",pagesText:"页",pageText:"页",toText:"到",jumpToText:"跳转到",currentText:"当前页",firstText:"第一页",lastText:"最后一页",numberText:"第"};E.defaultRegional=E.regional["zh-CN"];E.defaults={perPages:10,showPages:10,currentPage:1,_currentPage:1,totalItems:200,totalPages:0,pages:[],nextText:">",prevText:"<",ellipseText:"…",firstPage:0,lastPage:0,alwaysShowNext:false,alwaysShowPrev:false,showFirstOmit:false,showLastOmit:false,showJumper:false,getTemplate:function(G,F){return G},options:[],onJump:function(F,G){}};function A(G){var M=G.currentPage,I=Math.ceil(G.totalItems/G.perPages),K=[],F=G.showPages,J=M,H=M;G.totalPages=I;if(I<=F){for(var L=1;L<=I;L++){K.push(L)}}else{K.push(M);while(true){if(K.length>=F){break}if(J>1){K.unshift(--J)}if(K.length>=F){break}if(H<I){K.push(++H)}}}G.firstPage=K[0]||1;G.lastPage=K[K.length-1]||1;G.showFirstOmit=G.firstPage>2;G.showLastOmit=G.lastPage<I-1;return K}return B});